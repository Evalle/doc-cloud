<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet
 href="urn:x-daps:xslt:profiling:novdoc-profile.xsl" 
 type="text/xml"
 title="Profiling step"?>
<!DOCTYPE chapter PUBLIC "-//Novell//DTD NovDoc XML V1.0//EN" "novdocx.dtd"
[
  <!ENTITY % NOVDOC.DEACTIVATE.IDREF "IGNORE">
  <!ENTITY % entities SYSTEM "entity-decl.ent">
  %entities;
]>
<chapter id="cha.user.instances">
 <title>Launching and Managing Instances</title>
 <abstract>
  <para>Instances are virtual machines that run inside the cloud. To start
  an instance, you must have a virtual machine image that contains the following 
  information: which operating system to use, a user name and password with which 
  to log in to the &vmguest;, file storage etc. The cloud contains
  a pool of such images that cloud administrators have uploaded and made
  accessible to members of different projects. Apart from the image to use,
  you also need to specify the <quote>size</quote> of the VM to start 
  (called <literal>flavor</literal> in &ostack;) and to provide an SSH key. If 
  you want to make the virtual machine accessible from outside the
	cloud, you need to configure security groups. If needed, block storage
	devices (<literal>volumes</literal>) can be attached to a running
	instance (or detached and attached to another instance at any time).</para>
 </abstract>
 <!--taroth 2012-08-13-->
 <!--basic steps and tasks:
    * create keypair
    * configure security groups
    * launch instance
   [* log in to instance (SSH/VNC)] 
    * create volume
    * attach volume to instance/remove volume from instance
    * terminate/shut down instance
    -->
 <sect1 id="sec.user.instances.keys">
  <title>Creating or Importing Keys</title>
  <para>Before you can launch instances, you need to create a key pair. Keypairs
  are SSH credentials that are injected into images when they are launched.  
 </para>
  <procedure>
   <title>Creating a Keypair with the &cloud; &dash;</title>
   <para>
    <remark>taroth 2012-08-14: DEVs, do I need one keypair per project? or
   one keypair per image to launch?
   </remark>To allow login to an instance via SSH, create a keypair. If you have
   already created a keypair with an external tool, you can import it into
   &ostack;
   </para>
   <step>
    <para>Log in to &cloud; &dash; with your user name and password.</para>
   </step>
   <step>
    <para>If you are a member of multiple projects, select a project from the 
    drop-down list at the top of the <guimenu>Projects</guimenu>
    tab.</para>
   </step>
   <step>
    <para>Click the <guimenu>Access &amp; Security</guimenu> category. The &dash;
    shows <guimenu>Floating IPs</guimenu>, <guimenu>Security Groups</guimenu>, and
    <guimenu>Keypairs</guimenu> for the selected project.</para>
   </step>
   <step>
    <para>To import a keypair that you have generated with an external tool:</para>
    <substeps>
     <step>
      <para>Click <guimenu>Import Keypair</guimenu>.</para>
     </step>
     <step>
      <para>In the window that opens, enter a name for the keypair and
    copy the public key into the respective input field.</para>
     </step>
     <step>
      <para>Confirm your choice to make &ostack; register the public key at
      the Nova database.</para>
     </step>
    </substeps>
   </step>
   <step>
    <para>To create a new keypair:</para>
    <substeps>
     <step>
      <para>Click <guimenu>Create Keypair</guimenu>.</para>
     </step>
     <step>
      <para>In the window that opens, enter a name for the keypair and confirm 
      your choice.</para>
      <para>&ostack; generates a keypair and registers the public key at the Nova
    database. It provides the private key for download as a <filename>*.pem</filename>
    file.</para>
     </step>
     <step>
      <para>Save the <filename>*.pem</filename> file locally and change its 
      permissions so that only you can read and write to the file:</para>
      <screen>chmod 600 <replaceable>MY_PRIV_KEY</replaceable>.pem</screen>
     </step>
    </substeps>
   </step>
  </procedure>
 </sect1>
 <sect1 id="sec.user.instances.launch">
  <title>Launching an Instance</title>
  <para>After you have created or imported a keypair, you are now ready to launch 
    an instance in the cloud.</para>
  <procedure>
   <title>Launching an Instance with the &cloud; &dash;</title>
   <step>
    <para>Log in to &cloud; &dash; with your user name and password.</para>
   </step>
   <step>
    <para>If you are a member of multiple projects, select a project from the 
    drop-down list at the top of the <guimenu>Projects</guimenu>
    tab.</para>
   </step>
   <step>
    <para>Click the <guimenu>Images &amp; Snapshot</guimenu> category. Any virtual
    machine images that have been uploaded to Glance by the cloud administrator 
    and been made available to members of your project are visible there.
    </para>
   </step>
   <step>
    <para>Select an image and click <guimenu>Launch</guimenu>.</para>
   </step>
   <step>
    <para>In the window that opens, specify the following:</para>
    <substeps>
     <step>
      <para>Enter a <guimenu>Server Name</guimenu> that will be assigned to the
      virtual machine.</para>
     </step>
     <step>
      <para>From the <guimenu>Flavor</guimenu> drop-down list, select the 
      <quote>size</quote> of the virtual machine to launch.</para>
     </step>
     <step>
      <para>From the <guimenu>Keypair</guimenu> drop-down list,
     select one of the keypairs that you created beforehand. The public key
     will be injected to the image and will allow you to log in to
     the instance via SSH (provided you have allowed SSH access
     in the security group that is assigned to the image).</para>
     </step>
     <step>
      <para>Set the <guimenu>Instance Count</guimenu> to the number of 
     virtual machines to launch from this image.</para>
     </step>
     <step>
      <para>Activate the <guimenu>Security Groups</guimenu> that you want to
      assign to the instance.</para>
      <para>On the right-hand side, a chart shows the resources that are used 
      by any running instances you can check the current quota settings for 
      the project and compare them to the resources that will be used by this 
      instance.</para>
     </step>
     <step>
      <para>If all parameters are set according to your wishes, click 
     <guimenu>Launch Instance</guimenu>. The instance will be started on any of
     the &compnode; in the cloud. The &dash; shows the instance's status in the 
     <guimenu>Instances &amp; Volumes</guimenu> category.
     </para>
     </step>
    </substeps>
   </step>
  </procedure>
 </sect1>
 <sect1 id="sec.user.instances.secgroups">
  <title>Configuring Access to the Instances</title>
  <para>In &productname;, security groups are used to define which incoming 
  network traffic should be forwarded to instances. When launching an instance, 
  you need to define which security groups it should belong to. A default 
  security group is available for each project. It allows all network traffic
  from other members of this group and discards traffic from other IP addresses 
  and groups.</para>
  <para>Of course, rules of the default security group can be modified. 
  If necessary, you can also define multiple security groups for a project with 
  each group  holding a different set of firewall policies.</para>
  <para>As soon as the rules for a group a modified, the new rules are automatically 
  applied to all running instances belonging to that security group and to any 
  instances launched from then on.</para>
 </sect1>
</chapter>
