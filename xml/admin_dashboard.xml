<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet
 href="urn:x-daps:xslt:profiling:novdoc-profile.xsl" 
 type="text/xml"
 title="Profiling step"?>
<!DOCTYPE chapter PUBLIC "-//Novell//DTD NovDoc XML V1.0//EN" "novdocx.dtd"
[
  <!ENTITY % NOVDOC.DEACTIVATE.IDREF "IGNORE">
  <!ENTITY % entities SYSTEM "entity-decl.ent">
  %entities;
]>
<chapter id="cha.adm.dash">
 <title>Using &cloud; &dash;</title>
 <abstract>
  <para>
   &dash-descr-short;
  </para>

  <para>
   After a short introduction to the &dash;, learn how to execute key
   administration tasks such as managing projects and users, adding images,
   adding flavors, and setting quotas.
  </para>
 </abstract>
 <sect1 id="sec.adm.dash.req">
  <title>Requirements</title>
  &dash-req;
  </sect1>
 <sect1 id="sec.adm.dash.intro">
  <title>&cloud; &dash;&mdash;Overview</title>

  <para>
   Learn how to log in to &cloud; &dash; and get a short overview of its Web
   interface.
  </para>

  <sect2 id="sec.adm.dash.intro.login">
   <title>Logging in to the &cloud; &dash;</title>
   &dash-login;
   <figure>
    <title>&cloud; &dash;&mdash;Login Screen</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="cloud_dash_login_admin.png" width="60%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="cloud_dash_login_admin.png" width="50%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    After logging in, the &dash;&apos;s
    <xref linkend="sec.adm.dash.intro.main" xrefstyle="select:title nopage"/>
    appears.
   </para>
  </sect2>

  <sect2 id="sec.adm.dash.intro.main">
   <title>Main Screen (Administrator's View)</title>
   &dash-main-screen;  
   <para>
    If you are logged in as an administrator, the main screen shows the
    following tabs: <guimenu>Project</guimenu> and an
    <guimenu>Admin</guimenu>.
   </para>
   <sect3 id="sec.adm.dash.intro.main.project">
    <title>Main Screen&mdash;<guimenu>Project</guimenu> Tab</title>
    <para>
     The <guimenu>Project</guimenu> tab shows details for the projects 
     that the user who is logged in belongs to.
    </para>
    &dash-project-tab;
   </sect3>
   <sect3 id="sec.adm.dash.intro.main.admin">
    <title>Main Screen&mdash;<guimenu>Admin</guimenu> Tab</title>
    <figure>
     <title>&cloud; &dash;&mdash;<guimenu>Admin</guimenu> Tab</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="cloud_dash_admin.png" width="100%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="cloud_dash_admin.png" width="80%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
    <para>
     On this tab, you can access the following categories that belong to the <guimenu>System
      Panel</guimenu>:
    </para>
    <variablelist>
     <varlistentry>
      <term><guimenu>Overview</guimenu>
      </term>
      <listitem>
       <para>
        Shows basic reports.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>Instances</guimenu>
      </term>
      <listitem>
       <para><remark>taroth 2013-06-19: TODO- check!</remark>
        Lists all currently running instances belonging to various users and
        projects. (Not all projects may be visible to the administrator,
        though.)
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>Volumes</guimenu>
      </term>
      <listitem>
       <para>&wip;
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>Flavors</guimenu>
      </term>
      <listitem>
       <para>
        Lists the available <quote>sizes</quote> of the VMs that users may
        launch.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>Images</guimenu>
      </term>
      <listitem>
       <para><remark>taroth 2013-06-19: TODO - check!</remark>
        Shows the custom images that have been uploaded. Lets you add images, edit image
        properties or delete images, if needed.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>Projects</guimenu>
      </term>
      <listitem>
       <para>
        Lists the available projects. From here, you can create new projects
        and assign users to the projects.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>Users</guimenu>
      </term>
      <listitem>
       <para>
        Gives an overview of all users.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
     <term><guimenu>Networks</guimenu>
     </term>
     <listitem>
      <para>&wip;
      </para>
     </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>Routers</guimenu>
      </term>
      <listitem>
       <para>&wip;
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>System Info</guimenu>
      </term>
      <listitem>
       <para>
        Lists the defined <guimenu>Services</guimenu>, and the 
        <guimenu>Default Quotas</guimenu> (hard-coded in &ostack; &comp;).
        Includes parameters such as the number of CPUs, RAM, or instances.
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </sect3>
  </sect2>
 </sect1>
 <sect1 id="sec.adm.dash.projects.users">
  <title>Managing Projects and Users</title>
  
   &projects;
  

  <para>
   As a &cloud; administrator, you can create additional projects and users
   as needed. The following procedures guide you through the main management
   tasks like adding, modifying, or deleting projects and users. Learn how
   to assign users to one or multiple projects, or how to change or remove
   the assignment.
  </para>

  <remark>taroth 2012-07-23: found a lot of usability issues in the Web UI
   regarding user management, filed bnc#772633 - taroth 2013-06-18: TODO - 
   see https://bugzilla.novell.com/show_bug.cgi?id=772633#c4</remark>

  <procedure id="pro.adm.dash.project.create">
   <title>Creating or Deleting A Project</title>
   &project-disable;
   <step>
    <para>
     On the <guimenu>Admin</guimenu> tab, select the
     <guimenu>Projects</guimenu> category.
    </para>
   </step>
   <step>
    <para>
     To add a new project:
    </para>
    <substeps>
     <step>
      <para>
       Click <guimenu>Create Project</guimenu>.
      </para>
     </step>
     <step>
      <para>
       In the window that opens, enter a <guimenu>Name</guimenu> and
       <guimenu>Description</guimenu> for the project and confirm your
       changes.
      </para>
<!-- <informalfigure>
       <mediaobject>
        <imageobject role="fo">
         <imagedata fileref="cloud_dash_projects_create.png" width="60%" format="PNG"/>
        </imageobject>
        <imageobject role="html">
         <imagedata fileref="cloud_dash_projects_create.png" width="50%" format="PNG"/>
        </imageobject>
       </mediaobject>
       </informalfigure>-->
      <para>
       <remark>taroth 2013-06-19: TODO: new: project members and quotas can directly be defined for
        a project</remark>
       The &dash; automatically assigns an ID and shows the newly created
       project in the <guimenu>Projects</guimenu> category.
      </para>
     </step>
    </substeps>
   </step>
   <step>
    <para>
     To delete one or multiple projects:
    </para>
    <substeps>
     <step>
      <para>
       Activate the check boxes in front of the projects that you want to
       delete.
      </para>
     </step>
     <step>
      <para>
       Click <guimenu>Delete Projects</guimenu> and confirm your choice in
       the pop-up that appears.
      </para>
      <para>
       A message on the Web page shows if the action has been successful.
      </para>
     </step>
    </substeps>
   </step>
   <step>
    <para>
     To temporarily deactivate a project: Click 
     <menuchoice>
      <guimenu>More</guimenu>
      <guimenu>Edit Project</guimenu>
     </menuchoice> and deactivate the <guimenu>Enabled</guimenu> check
     box.
    </para>
   </step>
  </procedure>

  <figure>
   <title>&cloud; &dash;&mdash;List of Projects (Administrator's View)</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="cloud_dash_projects_list.png" width="100%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="cloud_dash_projects_list.png" width="80%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <procedure id="pro.adm.dash.user.create">
   <title>Creating Or Deleting Users Accounts</title>
  &users;
   <step>
    <para>
     On the <guimenu>Admin</guimenu> tab, select the
     <guimenu>Users</guimenu> category.
    </para>
   </step>
   <step>
    <para>
     To add a new user account:
    </para>
    <substeps>
     <step>
      <para> Click <guimenu>Create User</guimenu>. </para>
     </step>
     <step>
      <para> In the window that opens, enter a <guimenu>User Name</guimenu> and an
        <guimenu>Email</guimenu> address for the user. </para>
     </step>
     <step>
      <para> Set a preliminary <guimenu>Password</guimenu> for the user and confirm it. </para>
     </step>
     <step>
      <para> Assign the user to a <guimenu>Primary Project</guimenu> by selecting the respective
       project from the drop-down list.<remark>taroth 2013-06-19: new projects can now also be
        directly defined from here</remark>
      </para>
     </step>
     <step>
      <para>Assign the user to a <guimenu>Role</guimenu>. <remark>taroth 2013-06-19: TODO - find out
        where the roles are defined that appear here, if there are default roles and what they
        mean - taroth 2013-06-19: see below: pro.adm.dash.user.assign</remark>
      </para>
     </step>
     <step>
      <para> Confirm your changes. </para>
      <para> The &dash; automatically assigns an ID and shows the newly created user account in
       the <guimenu>Users</guimenu> category. </para>
     </step>
    </substeps>
   </step>
   <step>
    <para>
     To delete one or multiple users accounts:
    </para>
    <substeps>
     <step>
      <para>
       Activate the check boxes in front of the user accounts that you want
       to delete.
      </para>
     </step>
     <step>
      <para>
       Click <guimenu>Delete Users</guimenu> and confirm your choice in the
       pop-up that appears.
      </para>
      <para>
       A message on the Web page shows if the action has been successful.
      </para>
      <note>
       <title>Remove User from Primary Project</title>
       <para>
        <remark>taroth 2013-0619: different now, seems user can be deleted, no matter which role -
         TODO: check again</remark>
        If a user account cannot be deleted, it is because it is still
        assigned to its primary project.
       </para>
       <orderedlist>
        <listitem>
         <para>
          <guimenu>Edit</guimenu> the user data to view which
          <guimenu>Primary Project</guimenu> he is assigned to.
         </para>
        </listitem>
        <listitem>
         <para>
          Remove the user from his primary project as described in
          <xref linkend="pro.adm.dash.user.assign"/>,
          <xref linkend="step.adm.dash.user.remove.start" xrefstyle="select:label nopage"/>
          to
          <xref linkend="step.adm.dash.user.remove.end" xrefstyle="select:label nopage"/>.
         </para>
        </listitem>
       </orderedlist>
      </note>
     </step>
    </substeps>
   </step>
   <step>
    <para>
     To temporarily deactivate a user account: Select the user, and from the
     <guimenu>More</guimenu> drop-down list, select
     <guimenu>Disable</guimenu>.
    </para>
   </step>
  </procedure>

  <figure>
   <title>&cloud; &dash;&mdash;List of Users (Administrator's View)</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="cloud_dash_users.png" width="100%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="cloud_dash_users.png" width="80%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <procedure id="pro.adm.dash.user.assign">
   <title>Modifying User Assignments for a Project</title>
   <para>
    When creating new users, you must assign them to a primary project as
    described in <xref linkend="pro.adm.dash.user.create"/>. To assign users
    to additional projects or to modify and remove assignments, proceed as
    follows:
   </para>
   <step id="step.adm.dash.user.remove.start">
    <para>
     On the <guimenu>Admin</guimenu> tab, select the
     <guimenu>Projects</guimenu> category.
    </para>
   </step>
   <step>
    <para>
     Select the project for which to modify user assignments.
    </para>
   </step>
   <step>
    <para>
     Click <guimenu>Modify Users</guimenu>.
    </para>
    <para> The dialog that opens shows two lists of users on its <guimenu>Project Members</guimenu>'
     tab: <guimenu>All Users</guimenu> and <guimenu>Project Members</guimenu>.</para>
    <informalfigure>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="cloud_dash_users_list.png" width="100%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="cloud_dash_users_list.png" width="80%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </informalfigure>
   </step>
   <step id="step.adm.dash.user.remove.end">
    <para>
     To remove a user from the current project, select the respective user in the <guimenu>Project Members</guimenu>
     list and click the minus icon next to the user. 
     </para>
   </step>
   <step>
    <para>
     To assign a user to the current project:
    </para>
    <substeps>
     <step><para>Select a user from the <guimenu>All Users</guimenu>
      list and click the plus icon next to the user to move him to the <guimenu>Project
       Members</guimenu> list. </para></step>
     <step>
      <para>From the drop-down list, select the user's role with which to add him
       to the project and click <guimenu>Save</guimenu>. Roles define the
       actions that the user is allowed to perform. Roles are configured by
       the cloud operator in &ostack; &ident; (Keystone). Actions are
       defined per &ostack; service in the respective
       <filename>/etc/[SERVICE_CODENAME]/policy.json</filename> file, for
       example in <filename>/etc/nova/policy.json</filename> for the &comp;
       (Nova) service. For details, refer to
       <ulink url="http://docs.openstack.org/essex/openstack-compute/install/content/keystone-concepts.html"/>.
      </para>
<!--taroth 2012-08-02: who defines roles and actions? operator? admin? this also 
    defines where it should be documented - cthiel 2012-11-16: generally, operator
    does so, but roles are not changeable in Cloud 1.0 -->
<!--taroth 2012-08-02: info from the URL above-->
<!--The /etc/[SERVICE_CODENAME]/policy.json controls what users are allowed to do for a
       given service. For example, /etc/nova/policy.json specifies the access policy for the &comp;
       service, /etc/glance/policy.json specifies the access policy for the Image service, and
       /etc/keystone/policy.json specifies the access policy for the &ident; service. The default
       policy.json files in the &comp;, &ident;, and &img; service recognize only the admin role:
       all operations that do not require the admin role will be accessible by any user that has any
       role in a tenant. If you wish to restrict users from performing operations in, say, the
       &comp; service, you need to create a role in the &ident; service and then modify
       /etc/nova/policy.json so that this role is required for &comp; operations.-->
     </step>
    </substeps>
   </step>
  </procedure>
 </sect1>
 <sect1 id="sec.adm.dash.img">
  <title>Managing Images</title>
   &images;
   <!--taroth 2012-08-27: on behalf of cthiel, filed bnc#777504 (images can be
   managed by users/admins) - taroth 2013-06-18: TODO - info by vuntz: 
   In Grizzly, it's possible for non-admin users to edit/delete images. Of course,
   they can only do that for images that are in the project they're in (and not
   for public images).-->
  
   &img-manage;
   
   &img-props;
   
  <procedure id="pro.adm.dash.img.create">
   <title>Adding Images</title>
   <para>Since the &ostack; Grizzly release, it is possible to upload images also via the
    &dash;. Images can either be uploaded from external URLs or from a local file system. Upload
    of compressed image binaries (<literal>.zip</literal> and <literal>.tar.gz</literal>)is
    supported.</para>
    
   <note>
    <title>Limitations for Image Upload via &dash;</title>
    <itemizedlist>
     <listitem>
      <para>For upload from an external URL, the image must be available via a valid HTTP URL that
       leads directly to the image binary. URLs that redirect or serve error pages will result in
       unusable images. </para>
     </listitem>
     <listitem>
      <para>Avoid upload of large image via &dash;. For images sizes of several GB, it is
       strongly recommended to use the command-line tools. For details, refer to <xref
        linkend="sec.adm.cli.img.upload"/>.</para>
     </listitem>
    </itemizedlist>
   </note>

   <step>
    <para>
     On the <guimenu>Admin</guimenu> tab, select the
     <guimenu>Images</guimenu> category.
    </para>
   </step>
   <step>
    <para>To upload an image to the &ostack; &img; service:</para>
    <substeps>
     <step>
      <para>Click <guimenu>Create Image</guimenu>.</para>
     </step>
     <step>
      <para> In the window that opens, enter a <guimenu>Name</guimenu> for the image. </para>
     </step>
     <step>
      <para>If you have an external URL to upload the image from, enter the URL into <guimenu>Image
        Location</guimenu>. For a local image to upload, enter the path into <guimenu>Image
        File</guimenu> or click <guimenu>Browse</guimenu>.</para>
     </step>
     <step>
      <para>Select the image <guimenu>Format</guimenu>.</para>
     </step>
     <step>
      <para>If you want to specify a minimum disk size or minimum RAM size that is required to boot
       the image, enter the values into the respective input fields. Otherwise the minimums are set
       to <literal>0</literal>.</para>
     </step>
     <step>
      <para>Confirm your changes.</para>
     </step>
    </substeps>
   </step>
  </procedure>
  
   <para>
   After images have been added from the command line, they appear in the
   &cloud; &dash; on the <guimenu>Admin</guimenu> tab. View them in the
   <guimenu>Images</guimenu> category. From there, you can also
   <guimenu>Edit</guimenu> the image properties.
  </para>

  <para>
   If you need to delete an image, proceed as follows.
  </para>

  <procedure id="pro.adm.dash.img.delete">
   <title>Deleting Images</title>
   <step>
    <para>
     On the <guimenu>Admin</guimenu> tab, select the
     <guimenu>Images</guimenu> category.
    </para>
   </step>
   <step>
    <para>
     To delete one or multiple images, activate the check boxes in front of
     the images that you want to delete.
    </para>
   </step>
   <step>
    <para>
     Click <guimenu>Delete Images</guimenu> and confirm your choice in the
     pop-up that appears.
    </para>
    <para>
     A message on the Web page shows if the action has been successful.
    </para>
   </step>
  </procedure>
 </sect1>
 <sect1 id="sec.adm.dash.flavors">
  <title>Managing Flavors</title>
  &flavors;
  &flavor-params;
  <para>
   The default flavors are:
  <remark>taroth 2013-06-20: DEvs, please check: could not find the following one in the latest
   Dashboard installation: m1.smaller - does it still exist as default flavor? also the values for
   disk space etc. seem to have changed for some of the flavors - please verify if this a general
   change</remark></para>
  &flavors-default; 

  <para>
   Via the &cloud; &dash;, you can create new flavors or delete existing
   ones.
<!--taroth 2012-07-25: DEVs, is it possible at all to modify flavors?
  on the CLI, for example? taroth 2012-08-02: according to DEVs, seems only be
  possible by modifying the database ('UPDATE flavors SET foo=bla WHERE id=xx;'), 
  no 'nova flavor-update' or 'nova-manage flavor update' -> not for the docs :)
  bmwiedemann 2012-08-07: I had the following lines in my quickstart script
  exactly for that reason:
# makes life better with little RAM
echo "
use nova;
update instance_types set memory_mb=3072 where name='m1.medium';
update instance_types set memory_mb=4096 where name='m1.large';
update instance_types set memory_mb=5120 where name='m1.xlarge';
" | mysql -u root $pw-->
  </para>

  <procedure id="pro.adm.dash.flavors.create">
   <title>Creating or Deleting Flavors</title>
   <step>
    <para>
     On the <guimenu>Admin</guimenu> tab, select the
     <guimenu>Flavors</guimenu> category.
    </para>
   </step>
   <step>
    <para>
     To create a new flavor:
    </para>
    <substeps>
     <step>
      <para>
       Click <guimenu>Create Flavor</guimenu>.
      </para>
     </step>
     <step>
      <para>
       In the window that opens, specify the required parameters for the
       flavor.
      </para>
     </step>
     <step>
      <para>
       Confirm your changes.
      </para>
      <para>
       The newly created flavor will appear in the list of flavors and can
       be used when launching new instances.
<!--taroth 2012-07-25: todo - check if it possible to switch to a 
       newly created flavor in running instances - taroth 2012-11-21: 
       according to cthiel resize is only possible with special option 
       (allow_resize_to_same_host=True) which we do not have enabled-->
      </para>
     </step>
    </substeps>
   </step>
   <step>
    <para>
     To delete one or multiple flavors:
    </para>
    <substeps>
     <step>
      <para>
       Activate the check boxes in front of the flavors that you want to
       delete.
      </para>
     </step>
     <step>
      <para>
       Click <guimenu>Delete Flavors</guimenu> and confirm your choice in
       the pop-up that appears.
      </para>
      <para>
       A message on the Web page shows if the action has been successful.
<!--taroth 2012-07-25: check if a flavor can also be deleted if
      there is an instance running that uses that flavor - taroth 2012-11-21:
      acc. to cthiel this will result in error message-->
      </para>
     </step>
    </substeps>
   </step>
  </procedure>

  <figure>
   <title>&cloud; &dash;&mdash;List of Flavors (Administrator's View)</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="cloud_dash_flavors_list.png" width="100%" format="PNG" />
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="cloud_dash_flavors_list.png" width="80%" format="PNG" />
    </imageobject>
   </mediaobject>
  </figure>
 </sect1>
 <sect1 id="sec.adm.dash.quotas">
  <title>Setting Quotas</title>

  &quotas;
  
  &quota-params;
<!--taroth 2012-07-26: the "quota" category in the Admin tab
  does not make much sense to me as... it does not explain what is shown there,
  after some research found out that it always seems to show the same values, 
  then found the following: https://bugs.launchpad.net/horizon/+bug/973098-->

<para>
   <remark>taroth 2013-06-20: TODO - adjust wording of note or remove altogether since quotas are
    now shown in the System Info category on a separate tab called "Default Quotas" so it should be
    clear now anyway...</remark></para>
  <note>
   <title>Contents of the <guimenu>Quota</guimenu> Category</title>
   <para>
    The <guimenu>Quota</guimenu> category does not allow you to set any
    values, it just shows the global default quota values that are
    hard-coded in &ostack; Nova.
   </para>
  </note>

  <procedure id="pro.adm.dash.quota.set">
   <title>Setting Quotas for a Project</title>
   <step>
    <para>
     On the <guimenu>Admin</guimenu> tab, select the
     <guimenu>Projects</guimenu> category.
    </para>
   </step>
   <step>
    <para>
     Select the project for which to set or change quota values.
    </para>
   </step>
   <step>
    <para>
     From the <guimenu>More</guimenu> drop-down list, select
     <guimenu>Modify Quota</guimenu>.
    </para>
    <para>
     The window that opens shows the current quota values for the selected project. If no
     modifications have been made yet, the values reflect the default values per project that 
     are hard-coded in &ostack; Nova.
    </para>
   </step>
   <step>
    <para>
     Change the values for the quota parameters as desired.
    </para>
    <informalfigure>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="cloud_dash_projects_quota.png" width="60%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="cloud_dash_projects_quota.png" width="80%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </informalfigure>
   </step>
   <step>
    <para>
     Confirm your changes.
    </para>
   </step>
  </procedure>
 </sect1>
</chapter>
