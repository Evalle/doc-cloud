<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet
 href="urn:x-daps:xslt:profiling:novdoc-profile.xsl"
 type="text/xml"
 title="Profiling step"?>
<!DOCTYPE appendix PUBLIC "-//Novell//DTD NovDoc XML V1.0//EN" "novdocx.dtd"
[
  <!ENTITY % NOVDOC.DEACTIVATE.IDREF "IGNORE">
  <!ENTITY % entities SYSTEM "entity-decl.ent">
  %entities;
]>
<appendix id="app.deploy.vmware">
 <title>VMware vSphere Installation Instructions</title>
 <para>
  &cloud; supports the &o_comp; Compute VMware vCenter driver which enables
  access to advanced features such as vMotion, High Availability, and Dynamic
  Resource Scheduling (DRS). However, VMware vSphere is not supported
  <quote>natively</quote> by &cloud;&mdash;it rather delegates requests to an
  existing vCenter. It requires preparations at the vCenter and post install
  adjustments of the &compnode;.
 </para>
 <sect1 id="app.deploy.vmware.requirements">
  <title>Requirements</title>

  <para>
   The following requirements must be met in order to successfully deploy
   a &o_comp; Compute VMware node:
  </para>

  <itemizedlist>
   <listitem>
    <para>
     VMware vSphere vCenter 5.1
    </para>
   </listitem>
   <listitem>
    <para>
     VMware vSphere ESXi nodes 5.1
    </para>
   </listitem>
   <listitem>
    <para>
     Security groups are only supported when running VMWare NSX. You need to
     deploy &o_netw; with the <guimenu>vmware</guimenu> plugin as described in
     <xref linkend="sec.depl.ostack.quantum"/> to have security group
     support. This is also a prerequisite for <literal>gre</literal> tunnel
     support.
    </para>
   </listitem>
  </itemizedlist>
 </sect1>
 <sect1 id="app.deploy.vmware.vcenter">
  <title>Preparing the VMware vCenter Server</title>

  <para>
   &cloud; requires the VMware vCenter server to run version 5.1 or better.
   You need to create a single datacenter for &cloud; (multiple datacenters
   are currently not supported):
  </para>

  <procedure>
   <step>
    <para>
     Log in to the vCenter Server using the vSphere Web Client
    </para>
   </step>
   <step>
    <para>
     Choose <guimenu>Hosts and Clusters</guimenu> and create a
     single <guimenu>Datacenter</guimenu>
    </para>
   </step>
   <step>
    <para>
     Set up a <guimenu>New Cluster</guimenu> which has
     <guimenu>DRS</guimenu> enabled.
    </para>
   </step>
   <step>
    <para>
     Set <guimenu>Automation Level</guimenu> to <literal>Fully
     Automated</literal> and <guimenu>Migration Threshold</guimenu> to
     <literal>Aggressive</literal>.
    </para>
   </step>
   <step>
    <para>
     Create shared storage. Only shared storage is supported and data stores
     must be shared among all hosts in a cluster. It is recommended to remove
     data stores not intended for &ostack; from clusters being configured for
     &ostack;. Currently, a single data store can be used per cluster.
    </para>
   </step>
   <step>
    <para>
     Create a port group named <literal>br-int</literal>. Network devices of
     all instances will be attached to this group.
    </para>
   </step>
  </procedure>
 </sect1>
 <sect1 id="app.deploy.vmware.compnode">
  <title>Finishing the &o_comp; Compute VMware node Installation</title>

  <para>
   Deploy &o_comp; as described in <xref linkend="sec.depl.ostack.nova"/> on
   a single &compnode; and fill in the <guimenu>VMWare vCenter
   Settings</guimenu> attributes:
  </para>

  <variablelist>
   <varlistentry>
    <term><guimenu>vCenter IP Address</guimenu>
    </term>
    <listitem>
     <para>
      IP address of the vCenter server.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><guimenu>vCenter Username</guimenu> / <guimenu>vCenter
     Password</guimenu>
    </term>
    <listitem>
     <para>
      vCenter login credentials.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Cluster Names</term>
    <listitem>
     <para>
      A comma-separated list of cluster names you have added on the vCenter
      server.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>VLAN Interface</term>
    <listitem>
     <para>
      The physical interface that is to be used for VLAN networking. The
      default value of <literal>vmnic0</literal> references the first
      available interface (<quote>eth0</quote>). <literal>vmnic1</literal>
      would be the second interface (<quote>eth1</quote>).
     </para>
    </listitem>
   </varlistentry>
  </variablelist>

  <figure>
   <title>The &o_comp; &barcl;: VMware Configuration</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="depl_barclamp_nova_vmware.png" width="100%"
		format="png"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="depl_barclamp_nova_vmware.png" width="75%"
		format="png"/>
    </imageobject>
   </mediaobject>
  </figure>
 </sect1>
</appendix>
